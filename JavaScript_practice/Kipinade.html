<!DOCTYPE html>
<html>
<head><title>Kipinade</title>
<meta charset="utf-8"/>
<style>
@media (min-width: 280px) {body {font-size: 12px;} }
@media (min-width: 320px) {body {font-size: 14px;} }
@media (min-width: 423px) {body {font-size: 16px;} }
@media (min-width: 526px) {body {font-size: 21px;} }
@media (min-width: 768px) {body {font-size: 21px;} }
@media (min-width: 992px) {body {font-size: 21px;} }

body{
    background-color: #134;
	color: #fff;
	font-family: arial, verdana, "sans-serif";
	text-align: center;
}
.play-area{
   margin-top: 1.5em;
   width: 17.5em;
   display: inline-block;
}

.squares-grid{
	 width: 14.8em;
     background-color: #888;
     padding: 0.2em;
     border: 0.5em solid #134;
}

.square{
    height: 1.7em;
    width: 1.7em;
    border: 0.26em solid #888;
    display: inline-block;
	text-align: center;
	color: #fff;
	line-height: 1.7;
	font-weight: bold;
    font-size: 1em;
}

.controls-info{
    margin-top: 2em;
	width: 22em;
	vertical-align: top;
	text-align: left;
	display: inline-block;
}
.kip-btn{
    background-color: #afa;
    color: #000;
    width: 7em;
    height: 2em;
    border: none;
    border-radius: 15px;
    font-size: 0.8em;
	margin-right: 0.3em;
}
.info-box{
}
.stats-box{
   float: left;
   display: inline-block;
}
.stats-grid{
    margin-top: 1.5em;
   display: grid;
   width: 12em;  
   grid-template-columns: 6em 1.5em;
   grid-template-rows: 1em 1em 1em 1em 1em;
   grid-gap: 0.5em;
   margin-bottom: 1.5em;
}
.stats-heading{
  font-size: 0.8em;
}
.stats{
  font-size: 0.8em;
  text-align: right;
}
.notify{
   background-color: #fff;
   color: #000;
   display: none;
   margin-top: 0.5em;
   width: 10em;
   border-radius: 5%;
  /* display: inline-block;*/
}
.x{
   width: 98%;
   text-align: right;
   display: inline-block;
   font-size: 1.5em;
}
.x-htp{
   width: 98%;
   text-align: right;
   display: inline-block;
   font-size: 2em;
}
.note{
    padding: 0em;
	font-size: 0.9em;
	padding: 0 0.7em 0.7em 0.7em;
}
.play-instruct{
   font-size: 0.8em;
   text-align: left;
   background-color: #fff;
   color: #000;
   padding: 1em;
   border-radius: 5%;
   margin-right: 8%;
   position: absolute;
   top: 20%;
   left: 5%;
   display: none;
}
</style>

</head>
<body>

<div class="main-div">
    <h2 class="top-heading">Kipinade</h2>
	<div class="play-area">
			<div class="squares-grid" id="squares-grid">
				<div class="squares-row">
					 <div class="square" id='s00' onClick="modeDetect(0,0)"> </div>
					<div class="square" id='s01' onClick="modeDetect(0,1)"> </div>
					<div class="square" id='s02' onClick="modeDetect(0,2)"> </div>
					<div class="square" id='s03' onClick="modeDetect(0,3)"> </div>
					<div class="square" id='s04' onClick="modeDetect(0,4)"> </div>
					<div class="square" id='s05' onClick="modeDetect(0,5)"> </div>
					<div style="clear:both"></div>
				</div>
				<div class="squares-row">
					<div class="square" id='s10' onClick="modeDetect(1,0)"> </div>
					<div class="square" id='s11' onClick="modeDetect(1,1)"> </div>
					<div class="square" id='s12' onClick="modeDetect(1,2)"> </div>
					<div class="square" id='s13' onClick="modeDetect(1,3)"> </div>
					<div class="square" id='s14' onClick="modeDetect(1,4)"> </div>
					<div class="square" id='s15' onClick="modeDetect(1,5)"> </div>
					<div style="clear:both"></div>
				</div>
				<div class="squares-row">
					<div class="square" id='s20' onClick="modeDetect(2,0)"> </div>
					<div class="square" id='s21' onClick="modeDetect(2,1)"> </div>
					<div class="square" id='s22' onClick="modeDetect(2,2)"> </div>
					<div class="square" id='s23' onClick="modeDetect(2,3)"> </div>
					<div class="square" id='s24' onClick="modeDetect(2,4)"> </div>
					<div class="square" id='s25' onClick="modeDetect(2,5)"> </div>
					<div style="clear:both"></div>
				</div>
				<div class="squares-row">
					<div class="square" id='s30' onClick="modeDetect(3,0)"> </div>
					<div class="square" id='s31' onClick="modeDetect(3,1)"> </div>
					<div class="square" id='s32' onClick="modeDetect(3,2)"> </div>
					<div class="square" id='s33' onClick="modeDetect(3,3)"> </div>
					<div class="square" id='s34' onClick="modeDetect(3,4)"> </div>
					<div class="square" id='s35' onClick="modeDetect(3,5)"> </div>
					<div style="clear:both"></div>
				</div>
				<div class="squares-row">
					<div class="square" id='s40' onClick="modeDetect(4,0)"> </div>
					<div class="square" id='s41' onClick="modeDetect(4,1)"> </div>
					<div class="square" id='s42' onClick="modeDetect(4,2)"> </div>
					<div class="square" id='s43' onClick="modeDetect(4,3)"> </div>
					<div class="square" id='s44' onClick="modeDetect(4,4)"> </div>
					<div class="square" id='s45' onClick="modeDetect(4,5)"> </div>
					<div style="clear:both"></div>
				</div>
				<div class="squares-row">
					<div class="square" id='s50' onClick="modeDetect(5,0)"> </div>
					<div class="square" id='s51' onClick="modeDetect(5,1)"> </div>
					<div class="square" id='s52' onClick="modeDetect(5,2)"> </div>
					<div class="square" id='s53' onClick="modeDetect(5,3)"> </div>
					<div class="square" id='s54' onClick="modeDetect(5,4)"> </div>
					<div class="square" id='s55' onClick="modeDetect(5,5)"> </div>
					<div style="clear:both"></div>
				</div>
			</div>
	  </div>

   <div class="controls-info">
	       <div class="button-box">
			   <button type="button" class="kip-btn" id="swap" onclick="handleSwapBtn()">Swap Mode</button>
			    <button type="button" class="kip-btn" id="how" onclick="showHowToPlay()">How to Play</button>
				 <button type="button" class="kip-btn" id="new" onclick="newGame()">New Game</button>
			</div> 
			<div class="info-box">				
					 <div class="stats-box">
					       <div class="stats-grid">
								<div class="stats-heading">Moves:</div>
								<div class="stats" id="move">0</div>
								<div class="stats-heading">Squares To Visit:</div>
								<div class="stats" id="to-visit">36</div>
								<div class="stats-heading">Swaps Left:</div>
								<div class="stats" id="swaps">5</div>
								<div class="stats-heading">Score:</div>
								<div class="stats" id="score">0</div>
							</div>
					</div>
					
					<div class="notify" id="notify">
						<div class="x" id="x">&times;</div>	
						<div class="note" id="note"></div>
					</div> 
					<div style="clear:both"></div>
			</div>
	</div> 
	<div class="play-instruct" id="how-play">
	  <div class="x-htp" >&times;</div>	
	  <h3> How to Play Kipinade </h3>
	  <p>The object of the game is to visit every square on the board in as few moves as possible while using up as few as possible of the swaps.</p>
	  <p>The square that the player is on is marked with a white border around it. Players may move one square in any direction as long as the square they move to is the same number or colour as the square they start from. To move, a square next to the current square is clicked. </p>
	  <p>It is possible to get stuck in a position where there is no legal move available. When this happens, a swap can be performed. To do this, the player must click the 'Swap Mode' button. Then the player may choose any two squares on the board and have them change places. The swap is done by clicking once on each of the two squares that the player wishes to swap. Swaps must be used as sparingly as possible as only five swaps are allowed per game. Also, bonus points are added to the final score for each unused swap.</p>
	  <p>The game is won when all squares on the board have been visited. The game is lost if there are still squares left to visit but there are no legal moves available and no swaps left.
	</div>
</div>
<script type="text/javascript">

"use strict";

window.Kipinade = {};

Kipinade.posValues = [];
Kipinade.Square = function() { this.number = 0;
	                        this.colour = '#000000';
	                        this.visited = false; }
Kipinade.posIds = [ ['s00', 's01', 's02', 's03', 's04', 's05'],
			 ['s10', 's11', 's12', 's13', 's14', 's15'],
			 ['s20', 's21', 's22', 's23', 's24', 's25'],
			 ['s30', 's31', 's32', 's33', 's34', 's35'],
			 ['s40', 's41', 's42', 's43', 's44', 's45'],
			 ['s50', 's51', 's52', 's53', 's54', 's55']  ];
Kipinade.xPrev = -1;
Kipinade.yPrev = -1;
Kipinade.firstPairSet = false;
Kipinade.xFirst = -1;
Kipinade.yFirst = -1;
Kipinade.swapsMade = 0;
Kipinade.SWAPS_ALLOWED = 5;
Kipinade.CURRENT_COLOUR_MARKER = "#eee";
Kipinade.swapOn = false;
Kipinade.moves = 0;
Kipinade.squaresVisited = 0;
Kipinade.gameInProgress = true;
Kipinade.xClose = document.getElementsByClassName("x")[0];
Kipinade.notice = document.getElementById("notify");
Kipinade.xCloseHTP = document.getElementsByClassName("x-htp")[0];
Kipinade.howtoplay = document.getElementById("how-play");
Kipinade.NUMBER_OF_SQUARES_ON_BOARD = 36
Kipinade.NUMBER_OF_SQUARES_IN_ROW = 6;
Kipinade.NUMBER_OF_SQUARES_IN_COLUMN = 6;


setUpGame();

function setUpGame(){
     setUpInitialSquares();
     setInitialPosition();
}

function setUpInitialSquares(){
	 for(let i=0; i < Kipinade.NUMBER_OF_SQUARES_IN_COLUMN; i++){
	        Kipinade.posValues[i] = [];
			for(let j=0; j < Kipinade.NUMBER_OF_SQUARES_IN_ROW; j++){
			   var squareDefinition = pickRandomNumbersAndColours();
						   
			   Kipinade.posValues[i][j] = new Kipinade.Square();
			   Kipinade.posValues[i][j].number = squareDefinition.number;
			   Kipinade.posValues[i][j].colour = squareDefinition.colour;

			   document.getElementById(Kipinade.posIds[i][j]).innerHTML = Kipinade.posValues[i][j].number;
			   document.getElementById(Kipinade.posIds[i][j]).style.backgroundColor = Kipinade.posValues[i][j].colour;
			   document.getElementById(Kipinade.posIds[i][j]).style.color = "#fff";
			   document.getElementById(Kipinade.posIds[i][j]).style.borderColor = "#888";
			}
	 }
}

function setInitialPosition(){
       var initX;
       var initY;
	   
	   initX = Math.floor(Math.random() * 4 + 1);
	   initY = Math.floor(Math.random() * 4 + 1);
	   Kipinade.xPrev = initX;
	   Kipinade.yPrev = initY;
	   
	   document.getElementById(Kipinade.posIds[initX][initY]).style.borderColor = Kipinade.CURRENT_COLOUR_MARKER;
}

function handleSwapBtn(){
	  if(Kipinade.gameInProgress){
		   if(Kipinade.swapOn){
			  document.getElementById('swap').style.backgroundColor = "#afa";
			  document.getElementById('squares-grid').style.borderColor = "#134";
			  Kipinade.swapOn = false;
		   }
		   else{
			  document.getElementById('swap').style.backgroundColor = "#8ff";
			  document.getElementById('squares-grid').style.borderColor = "#8ff";
			  Kipinade.swapOn = true;
		   }
	  }
}

function modeDetect(x,y){
    Kipinade.xClose.onclick();
    if(Kipinade.gameInProgress){
       if(Kipinade.swapOn){
          swap(x,y);
       }
       else{
          move(x,y);
       }
   }  
}

function move(x,y){  
    var diffX = x - Kipinade.xPrev;
	var diffY = y - Kipinade.yPrev;
	if (diffX > -2 && diffX < 2 && diffY > -2 && diffY < 2){
             if( Kipinade.posValues[x][y].number == Kipinade.posValues[Kipinade.xPrev][Kipinade.yPrev].number || Kipinade.posValues[x][y].colour === Kipinade.posValues[Kipinade.xPrev][Kipinade.yPrev].colour ){
		        document.getElementById(Kipinade.posIds[x][y]).style.borderColor = Kipinade.CURRENT_COLOUR_MARKER;
				console.log(`X= ${x}   Y= ${y}`);
		        document.getElementById(Kipinade.posIds[Kipinade.xPrev][Kipinade.yPrev]).style.borderColor = "#888";
				
				Kipinade.moves++;
		       				
				if(Kipinade.posValues[x][y].visited == false){
				   document.getElementById(Kipinade.posIds[x][y]).style.color = "#000";
				   Kipinade.posValues[x][y].visited = true;
				   Kipinade.squaresVisited++
				   document.getElementById("to-visit").innerHTML = Kipinade.NUMBER_OF_SQUARES_ON_BOARD - Kipinade.squaresVisited;
				   
				   if (Kipinade.squaresVisited >= Kipinade.NUMBER_OF_SQUARES_ON_BOARD){
				      notifyUser("Game Over! You have won!!!");
                      calculateScore();
					  endGame();					  
				   }
				}
				 var squareDefinition = pickRandomNumbersAndColours();
				 Kipinade.posValues[Kipinade.xPrev][Kipinade.yPrev].number = squareDefinition.number;
			     Kipinade.posValues[Kipinade.xPrev][Kipinade.yPrev].colour = squareDefinition.colour;
		         document.getElementById(Kipinade.posIds[Kipinade.xPrev][Kipinade.yPrev]).innerHTML = Kipinade.posValues[Kipinade.xPrev][Kipinade.yPrev].number;
                 document.getElementById(Kipinade.posIds[Kipinade.xPrev][Kipinade.yPrev]).style.backgroundColor = Kipinade.posValues[Kipinade.xPrev][Kipinade.yPrev].colour;
		         Kipinade.xPrev = x;
		         Kipinade.yPrev = y;
                 
				 checkForLegalMoves(x,y);
				
                 document.getElementById('move').innerHTML = Kipinade.moves;
              }
              else{
				 notifyUser("You may only move to a square that has the same number or the same colour as the one you are on.");				  
              }
	}
	else{
		notifyUser("You may not move more than one square at a time. Please try again.");
	}
}

function swap(x,y){
      if(Kipinade.swapsMade < Kipinade.SWAPS_ALLOWED){
			if (Kipinade.firstPairSet){
			   document.getElementById(Kipinade.posIds[Kipinade.xFirst][Kipinade.yFirst]).style.opacity = "1";
			   
			   let shelfNumber = Kipinade.posValues[x][y].number; 
			   Kipinade.posValues[x][y].number = Kipinade.posValues[Kipinade.xFirst][Kipinade.yFirst].number;
			   Kipinade.posValues[Kipinade.xFirst][Kipinade.yFirst].number = shelfNumber;
			   
			   document.getElementById(Kipinade.posIds[Kipinade.xFirst][Kipinade.yFirst]).innerHTML = Kipinade.posValues[Kipinade.xFirst][Kipinade.yFirst].number;
			   document.getElementById(Kipinade.posIds[x][y]).innerHTML = Kipinade.posValues[x][y].number;
			   
			   let shelfColour = Kipinade.posValues[x][y].colour; 
			   Kipinade.posValues[x][y].colour = Kipinade.posValues[Kipinade.xFirst][Kipinade.yFirst].colour;
			   Kipinade.posValues[Kipinade.xFirst][Kipinade.yFirst].colour = shelfColour;
			   
			   document.getElementById(Kipinade.posIds[Kipinade.xFirst][Kipinade.yFirst]).style.backgroundColor = Kipinade.posValues[Kipinade.xFirst][Kipinade.yFirst].colour;
			   document.getElementById(Kipinade.posIds[x][y]).style.backgroundColor = Kipinade.posValues[x][y].colour;
			   Kipinade.firstPairSet = false;
			   Kipinade.swapsMade++;
			   document.getElementById("swaps").innerHTML = Kipinade.SWAPS_ALLOWED - Kipinade.swapsMade;
			   handleSwapBtn();
			}
			else{
			   Kipinade.xFirst = x;
			   Kipinade.yFirst = y;
			   document.getElementById(Kipinade.posIds[Kipinade.xFirst][Kipinade.yFirst]).style.opacity = "0.3";
			   Kipinade.firstPairSet = true;			    
			}	     			
	  }
	  else{	       
			notifyUser("Sorry, you may not make another swap at this time, your five swaps have all been used.");
	  }
}
function checkForLegalMoves(x,y){
     var gameCond = "in progress";
   
    if (Kipinade.swapsMade >= Kipinade.SWAPS_ALLOWED){     
		  if(x > 0 && x < 5 && y > 0 && y < 5){  
			  if (Kipinade.posValues[x][y].number != Kipinade.posValues[x-1][y-1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x-1][y].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x-1][y+1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x][y-1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x][y+1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x+1][y-1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x+1][y].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x+1][y+1].number){
				  
				  if (Kipinade.posValues[x][y].colour !== Kipinade.posValues[x-1][y-1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x-1][y].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x-1][y+1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x][y-1].number && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x][y+1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x+1][y-1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x+1][y].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x+1][y+1].colour){
					  
				 // alert(`No match for either numbers or colours`);
				  gameCond = "lost";
				  }
			
		      }
		  } 
		  else if(x == 0 && y > 0 && y < 5){
		      
			  if (Kipinade.posValues[x][y].number != Kipinade.posValues[x][y-1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x][y+1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x+1][y-1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x+1][y].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x+1][y+1].number){
			
				  if (Kipinade.posValues[x][y].colour !== Kipinade.posValues[x][y-1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x][y+1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x+1][y-1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x+1][y].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x+1][y+1].colour){
					  
				//  alert(`No match for either numbers or colours`);
				  gameCond = "lost";
				  }
			
		      }
		  }
		  else if(x > 0 && x < 5 && y == 0){

			  if (Kipinade.posValues[x][y].number != Kipinade.posValues[x-1][y].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x-1][y+1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x][y+1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x+1][y].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x+1][y+1].number){
				  
				  if (Kipinade.posValues[x][y].colour !== Kipinade.posValues[x-1][y].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x-1][y+1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x][y+1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x+1][y].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x+1][y+1].colour){
					 
				 // alert(`No match for either numbers or colours`);
				  gameCond = "lost";
				  }
			
		      }
		  }
		  else if(x > 0 && x < 5 && y == 5){

			  if (Kipinade.posValues[x][y].number != Kipinade.posValues[x-1][y-1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x-1][y].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x][y-1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x+1][y-1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x+1][y].number){
				  
				  if (Kipinade.posValues[x][y].colour !== Kipinade.posValues[x-1][y-1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x-1][y].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x][y-1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x+1][y-1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x+1][y].colour){
					  
				 // alert(`No match for either numbers or colours`);
				  gameCond = "lost";
				  }
			
		      }
		  }
		  else if(x == 5 && y > 0 && y < 5){

			  if (Kipinade.posValues[x][y].number != Kipinade.posValues[x-1][y-1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x-1][y].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x-1][y+1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x][y-1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x][y+1].number){
				  
				  if (Kipinade.posValues[x][y].colour !== Kipinade.posValues[x-1][y-1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x-1][y].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x-1][y+1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x][y-1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x][y+1].colour){
					  
				 // alert(`No match for either numbers or colours`);
				  gameCond = "lost";
				  }
			
		      }
		  }
		  else if(x == 0 && y == 0){

			  if (Kipinade.posValues[x][y].number != Kipinade.posValues[x][y+1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x+1][y].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x+1][y+1].number){
				  
				  if (Kipinade.posValues[x][y].colour !== Kipinade.posValues[x][y+1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x+1][y].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x+1][y+1].colour){
					  
				 // alert(`No match for either numbers or colours`);
				  gameCond = "lost";
				  }
			
		      }
		  }
		  else if(x == 0 && y == 5){

			  if (Kipinade.posValues[x][y].number != Kipinade.posValues[x][y-1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x+1][y-1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x+1][y].number){
				  
				  if (Kipinade.posValues[x][y].colour !== Kipinade.posValues[x][y-1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x+1][y-1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x+1][y].colour){
					  
				 // alert(`No match for either numbers or colours`);
				  gameCond = "lost";
				  }
			
		      }
		  }
		  else if(x == 5 && y == 0){

			  if (Kipinade.posValues[x][y].number != Kipinade.posValues[x-1][y].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x-1][y+1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x][y+1].number){
				
				  if (Kipinade.posValues[x][y].colour !== Kipinade.posValues[x-1][y].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x-1][y+1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x][y+1].colour){
					  
				 // alert(`No match for either numbers or colours`);
				  gameCond = "lost";
				  }
			
		      }
		  }
		    else if(x == 5 && y == 5){

			  if (Kipinade.posValues[x][y].number != Kipinade.posValues[x-1][y-1].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x-1][y].number && Kipinade.posValues[x][y].number != Kipinade.posValues[x][y-1].number){
				  
				  if (Kipinade.posValues[x][y].colour !== Kipinade.posValues[x-1][y-1].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x-1][y].colour && Kipinade.posValues[x][y].colour !== Kipinade.posValues[x][y-1].colour){
					  
				 // alert(`No match for either numbers or colours`);
				  gameCond = "lost";
				  }
			
		      }
		  }
    }
	if(gameCond === "lost"){
	    //alert("in lost");
	    notifyUser("There are no legal moves possible and no swaps remain. You have lost the game. Better luck next time.");
	}
}
function calculateScore(){
     let movesTotalBonus = Math.round((1/Kipinade.moves) * 100000);
     let swapsLeftBonus = (Kipinade.SWAPS_ALLOWED - Kipinade.swapsMade) * 150;
     let finalScore = Kipinade.moves + movesTotalBonus + swapsLeftBonus;
     document.getElementById('score').innerHTML = finalScore;
}

function notifyUser(msg) { 
   document.getElementById('note').innerHTML = msg;
   Kipinade.notice.style.display = "inline-block";
}
function showHowToPlay() { 
  document.getElementById('how-play').style.dsiplay = "inline-block";
  Kipinade.howtoplay.style.display = "inline-block";
}

Kipinade.xClose.onclick = function() {
  Kipinade.notice.style.display = "none";
}
Kipinade.xCloseHTP.onclick = function() {
  Kipinade.howtoplay.style.display = "none";
}
function endGame(){
   Kipinade.gameInProgress = false;
}

function pickRandomNumbersAndColours(){
      let randNum = Math.floor(Math.random() * 5 + 1);
	  let randColN = Math.floor(Math.random() * 5 + 1);
		   switch(randColN){
			  case 1:
				  var randCol = "#0011dd";
				  break;
			  case 2:
				  var randCol = "#dd9900";
				  break;
			  case 3:
				  var randCol = "#228822";
				  break;
			  case 4:
				  var randCol = "#cc0022";
				  break;
			  case 5:
				  var randCol = "#663377";
				  break;
			  default: alert("none matched in switch");
		   } 
	  return {number: randNum, colour: randCol};
}
function newGame(){
    Kipinade.xPrev = -1;
	Kipinade.yPrev = -1;
	Kipinade.firstPairSet = false;
	Kipinade.xFirst = -1;
	Kipinade.yFirst = -1;
	Kipinade.swapsMade = 0;
	Kipinade.swapOn = false;
	Kipinade.moves = 0;
	Kipinade.squaresVisited = 0;
	Kipinade.gameInProgress = true;
	Kipinade.notice.style.display = "none";
	
	setUpGame();
	
	document.getElementById('move').innerHTML = 0;	
	document.getElementById('to-visit').innerHTML = 36;	
	document.getElementById("swaps").innerHTML = Kipinade.SWAPS_ALLOWED;
	document.getElementById('score').innerHTML = 0;
}
</script>

</body>
</html>

